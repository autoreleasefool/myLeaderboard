(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t,r){e.exports=r(275)},269:function(e,t,r){},270:function(e,t,r){},271:function(e,t,r){},272:function(e,t,r){},273:function(e,t,r){},274:function(e,t,r){},275:function(e,t,r){"use strict";r.r(t);var n=r(18),a=r(0),s=r.n(a),i=r(27),o=r.n(i),c=r(17),u=r(14),l=r(22),h=r(21),p=r(23),f=r(6),v=r.n(f),m=r(15),d=r(111),y=r.n(d);function b(){return w.apply(this,arguments)}function w(){return(w=Object(m.a)(v.a.mark(function e(){var t,r,n,a,s,i,o,c;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getInstance().dir("data");case 2:for(t=e.sent,r=[],n=!0,a=!1,s=void 0,e.prev=7,i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0)"file"===(c=o.value).type&&c.name.endsWith(".json")&&r.push(c.name.split(".")[0]);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),a=!0,s=e.t0;case 15:e.prev=15,e.prev=16,n||null==i.return||i.return();case 18:if(e.prev=18,!a){e.next=21;break}throw s;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.abrupt("return",r);case 24:case"end":return e.stop()}},e,null,[[7,11,15,23],[16,,18,22]])}))).apply(this,arguments)}var k=function(){function e(t){Object(c.a)(this,e),this.octo=void 0,this.repo=void 0,this.userCache=new Map,this.dirCache=new Map,this.contentsCache=new Map,this.blobCache=new Map,this.octo=y.a({token:t}),this.repo=this.octo.repos("josephroquedev","myLeaderboard")}return Object(u.a)(e,null,[{key:"setToken",value:function(t){e.token=t,e.instance=void 0}},{key:"setBranch",value:function(t){e.branch=t}},{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e(e.token)),e.instance}}]),Object(u.a)(e,[{key:"clearCache",value:function(){this.userCache.clear(),this.contentsCache.clear(),this.blobCache.clear()}},{key:"players",value:function(){var e=Object(m.a)(v.a.mark(function e(){var t,r,n,a,s,i,o,c,u,l,h,p,f,m,d,y,w,k,g,x,j,O,S,E,C=arguments;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=C.length>0&&void 0!==C[0]?C[0]:void 0,r=new Set,n=[],null!=t){e.next=9;break}return e.next=6,b();case 6:a=e.sent,e.next=10;break;case 9:a=[t];case 10:s=!0,i=!1,o=void 0,e.prev=13,c=a[Symbol.iterator]();case 15:if(s=(u=c.next()).done){e.next=42;break}return l=u.value,e.next=19,this.playersForGame(l);case 19:for(h=e.sent,p=!0,f=!1,m=void 0,e.prev=23,d=h[Symbol.iterator]();!(p=(y=d.next()).done);p=!0)w=y.value,!1===r.has(w.username)&&(r.add(w.username),n.push(w));e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),f=!0,m=e.t0;case 31:e.prev=31,e.prev=32,p||null==d.return||d.return();case 34:if(e.prev=34,!f){e.next=37;break}throw m;case 37:return e.finish(34);case 38:return e.finish(31);case 39:s=!0,e.next=15;break;case 42:e.next=48;break;case 44:e.prev=44,e.t1=e.catch(13),i=!0,o=e.t1;case 48:e.prev=48,e.prev=49,s||null==c.return||c.return();case 51:if(e.prev=51,!i){e.next=54;break}throw o;case 54:return e.finish(51);case 55:return e.finish(48);case 56:for(k=[],g=0,x=n;g<x.length;g++)j=x[g],k.push(this.user(j.username));return e.next=60,Promise.all(k);case 60:for(O=e.sent,S=[],E=0;E<n.length;E++)S.push({avatar:O[E].avatarUrl,displayName:n[E].displayName,username:n[E].username});return e.abrupt("return",S);case 64:case"end":return e.stop()}},e,this,[[13,44,48,56],[23,27,31,39],[32,,34,38],[49,,51,55]])}));return function(){return e.apply(this,arguments)}}()},{key:"playersForGame",value:function(){var e=Object(m.a)(v.a.mark(function e(t){var r,n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contents("data/".concat(t,".json"));case 2:return r=e.sent,n=JSON.parse(r),e.abrupt("return",n.players);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"user",value:function(){var e=Object(m.a)(v.a.mark(function e(t){var r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("@"===t.charAt(0)&&(t=t.substr(1)),!this.userCache.has(t)){e.next=5;break}return e.abrupt("return",this.userCache.get(t));case 5:return e.next=7,this.octo.users(t).fetch();case 7:return r=e.sent,this.userCache.set(t,r),e.abrupt("return",r);case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"dir",value:function(){var t=Object(m.a)(v.a.mark(function t(r){var n,a;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(n=this.dirCache.get(r))){t.next=7;break}return t.next=4,this.repo.contents(r).read({ref:e.branch});case 4:a=t.sent,this.dirCache.set(r,a.items),n=a.items;case 7:return t.abrupt("return",n);case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"contents",value:function(){var t=Object(m.a)(v.a.mark(function t(r){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.contentsCache.has(r)){t.next=4;break}return t.abrupt("return",this.contentsCache.get(r));case 4:return t.next=6,this.repo.contents(r).read({ref:e.branch});case 6:return n=t.sent,this.contentsCache.set(r,n),t.abrupt("return",n);case 9:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"blob",value:function(){var e=Object(m.a)(v.a.mark(function e(t){var r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.blobCache.has(t)){e.next=4;break}return e.abrupt("return",this.blobCache.get(t));case 4:return e.next=6,this.repo.contents(t).fetch();case 6:return(r=e.sent).content=(n=r.content,atob(n)),this.blobCache.set(t,r),e.abrupt("return",r);case 10:case"end":return e.stop()}var n},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"commits",value:function(){var t=Object(m.a)(v.a.mark(function t(r){var n,a,s,i,o,c,u,l,h;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=r){t.next=6;break}return t.next=3,this.repo.commits.fetch({sha:e.branch});case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,this.repo.commits.fetch({since:r.toISOString(),sha:e.branch});case 8:t.t0=t.sent;case 9:for(n=t.t0,a=n.items,s=[],i=!0,o=!1,c=void 0,t.prev=15,u=a[Symbol.iterator]();!(i=(l=u.next()).done);i=!0)h=l.value,s.push(h.commit);t.next=23;break;case 19:t.prev=19,t.t1=t.catch(15),o=!0,c=t.t1;case 23:t.prev=23,t.prev=24,i||null==u.return||u.return();case 26:if(t.prev=26,!o){t.next=29;break}throw c;case 29:return t.finish(26);case 30:return t.finish(23);case 31:return t.abrupt("return",s);case 32:case"end":return t.stop()}},t,this,[[15,19,23,31],[24,,26,30]])}));return function(e){return t.apply(this,arguments)}}()},{key:"write",value:function(){var e=Object(m.a)(v.a.mark(function e(t){var r,n,a,s,i,o;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=!0,n=!1,a=void 0,e.prev=3,s=t[Symbol.iterator]();case 5:if(r=(i=s.next()).done){e.next=12;break}return o=i.value,e.next=9,this.repo.contents(o.path).add({content:(c=o.content,btoa(c)),message:null!=o.message?o.message:"Updating ".concat(o.path),sha:o.sha});case 9:r=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),n=!0,a=e.t0;case 18:e.prev=18,e.prev=19,r||null==s.return||s.return();case 21:if(e.prev=21,!n){e.next=24;break}throw a;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}var c},e,this,[[3,14,18,26],[19,,21,25]])}));return function(t){return e.apply(this,arguments)}}()}]),e}();k.instance=void 0,k.branch="master",k.token=void 0;var g=k,x=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(l.a)(this,Object(h.a)(t).call(this,e))).refreshInterval=void 0,r.startTime=void 0,r.startTime=new Date,r.state={errorMessage:void 0},r}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._startRefreshLoop()}},{key:"render",value:function(){var e=this,t=this.state.errorMessage;return null==t?null:s.a.createElement(n.e,{title:""},s.a.createElement(n.c,null,s.a.createElement(n.b,{title:"Failed to refresh",onDismiss:function(){return e._startRefreshLoop()},status:"critical"},s.a.createElement("p",null,t))))}},{key:"_startRefreshLoop",value:function(){var e=this;null!=this.state.errorMessage&&this.setState({errorMessage:void 0}),null!=this.refreshInterval&&window.clearInterval(this.refreshInterval),this.refreshInterval=window.setInterval(function(){return e._refreshLoop()},this.props.refreshTime)}},{key:"_refreshLoop",value:function(){var e=Object(m.a)(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.getInstance().commits(this.startTime);case 3:e.sent.length>0&&window.location.reload(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.setState({errorMessage:"".concat(e.t0)});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()}]),t}(s.a.Component);r(269),r(270);function j(e){var t=((new Date).getTime()-e.lastPlayed.getTime())/1e3,r=Math.floor(t/86400);return r<7?1:r>30?0:Math.min((23-(r-7))/23,1)}function O(e){return 0===j(e)}var S=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={banished:[]},r}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._identifyBanishedPlayers()}},{key:"componentDidUpdate",value:function(e){this.props.players!==e.players&&this._identifyBanishedPlayers()}},{key:"render",value:function(){return 0===this.state.banished.length?null:s.a.createElement(n.e,{title:"Shadow Realm"},s.a.createElement("div",{className:"shadowRealm"},this.state.banished.map(function(e){return s.a.createElement(E,{key:e.username,player:e,banished:!0})})))}},{key:"_identifyBanishedPlayers",value:function(){var e=this.props.players.filter(function(e){return O(e)});this.setState({banished:e})}}]),t}(s.a.Component);r(271);var E=function(e){var t,r=e.player;return t=e.banished||e.limbo?1:j(r),s.a.createElement("img",{src:r.avatar,alt:r.displayName,className:"avatar",style:{opacity:t}})},C=(r(272),function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={limboing:[]},r}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.players.filter(function(e){var t=j(e);return t>0&&t<.2});this.setState({limboing:e})}},{key:"render",value:function(){return 0===this.state.limboing.length?null:s.a.createElement(n.e,{title:"Limbo"},s.a.createElement("div",{className:"limbo"},this.state.limboing.map(function(e){return s.a.createElement(E,{key:e.username,player:e,limbo:!0})})))}}]),t}(s.a.Component)),R=r(65),_=5,M=0,P=0;var N=function(){return s.a.createElement("p",null,"v".concat(_,".").concat(M,".").concat(P))},I=(r(273),function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={banishedPlayers:new Set,gamePlayers:[]},r}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._parseStandings()}},{key:"componentDidUpdate",value:function(e){this.props.standings!==e.standings&&this._parseStandings()}},{key:"render",value:function(){var e=this,t=this.props,r=t.game,a=t.players,i=this.state.gamePlayers,o=this._mapPlayerNamesToPlayers(a);return s.a.createElement(n.e,{title:r},s.a.createElement(n.c,null,s.a.createElement(n.d,{columnContentTypes:i.map(function(e){return"text"}),headings:[],rows:[[s.a.createElement(N,null),"Total"].concat(Object(R.a)(i.map(function(e){return s.a.createElement(E,{player:o.get(e.username)})})))].concat(Object(R.a)(i.map(function(t){var r=[],n=!0,a=!1,c=void 0;try{for(var u,l=i[Symbol.iterator]();!(n=(u=l.next()).done);n=!0){var h=u.value;h.username!==t.username?r.push(e._formatRecord(t.records.get(h.username),!1)):r.push("\u2014")}}catch(p){a=!0,c=p}finally{try{n||null==l.return||l.return()}finally{if(a)throw c}}return[s.a.createElement(E,{key:t.username,player:o.get(t.username)}),e._formatRecord(t.total,!0)].concat(r)})))})))}},{key:"_parseStandings",value:function(){var e=this.props.standings,t=new Map,r=new Map,n=!0,a=!1,s=void 0;try{for(var i,o=e.players[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){for(var c=i.value,u={wins:0,losses:0,ties:0},l=0,h=Object.keys(e.records[c.username]);l<h.length;l++){var p=h[l],f=e.records[c.username][p],v=f.wins,m=f.losses,d=f.ties;!1===r.has(c.username)&&r.set(c.username,new Map),r.get(c.username).set(p,{wins:v,losses:m,ties:d}),u.wins+=v,u.losses+=m,u.ties+=d}t.set(c.username,u)}}catch(k){a=!0,s=k}finally{try{n||null==o.return||o.return()}finally{if(a)throw s}}var y=this._identifyInvisiblePlayers(t),b=this._identifyBanishedPlayers(this.props.players),w=this.props.players.filter(function(e){return!1===y.has(e.username)&&!1===b.has(e.username)}).map(function(e){return{records:r.get(e.username),total:t.get(e.username),username:e.username}});this._highlightRecords(w),this.setState({banishedPlayers:b,gamePlayers:w})}},{key:"_identifyInvisiblePlayers",value:function(e){return new Set(Array.from(e.keys()).filter(function(t){var r=e.get(t);return r.wins+r.losses+r.ties===0}))}},{key:"_identifyBanishedPlayers",value:function(e){return new Set(e.filter(function(e){return O(e)}).map(function(e){return e.username}))}},{key:"_highlightRecords",value:function(e){var t=[{player:void 0,winRate:1/0,losses:0,wins:0}],r=[{player:void 0,winRate:-1/0,losses:0,wins:0}],n=!0,a=!1,s=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,u=c.total.wins+c.total.losses+c.total.ties,l=c.total.wins/u,h={player:c.username,winRate:l,losses:c.total.losses,wins:c.total.wins};this._updateHighlightedRecords(h,r,t);var p=[{player:void 0,winRate:1/0,losses:0,wins:0}],f=[{player:void 0,winRate:-1/0,losses:0,wins:0}],v=!0,m=!1,d=void 0;try{for(var y,b=c.records.keys()[Symbol.iterator]();!(v=(y=b.next()).done);v=!0){var w=y.value,k=c.records.get(w),g=k.wins+k.losses+k.ties,x={player:w,winRate:k.wins/g,losses:k.losses,wins:k.wins};this._updateHighlightedRecords(x,f,p)}}catch(M){m=!0,d=M}finally{try{v||null==b.return||b.return()}finally{if(m)throw d}}this._markBestAndWorstRecords(c.records,f,p)}}catch(M){a=!0,s=M}finally{try{n||null==o.return||o.return()}finally{if(a)throw s}}var j=new Map,O=!0,S=!1,E=void 0;try{for(var C,R=e[Symbol.iterator]();!(O=(C=R.next()).done);O=!0){var _=C.value;j.set(_.username,_.total)}}catch(M){S=!0,E=M}finally{try{O||null==R.return||R.return()}finally{if(S)throw E}}this._markBestAndWorstRecords(j,r,t)}},{key:"_updateHighlightedRecords",value:function(e,t,r){e.winRate>t[0].winRate?(t.length=0,t.push(e)):e.winRate===t[0].winRate&&(e.wins>t[0].wins?(t.length=0,t.push(e)):e.wins===t[0].wins&&t.push(e)),e.winRate<r[0].winRate?(r.length=0,r.push(e)):e.winRate===r[0].winRate&&(e.losses>r[0].losses?(r.length=0,r.push(e)):e.losses===t[0].losses&&r.push(e))}},{key:"_markBestAndWorstRecords",value:function(e,t,r){var n=!0,a=!1,s=void 0;try{for(var i,o=e.keys()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,u=e.get(c),l=!0,h=!1,p=void 0;try{for(var f,v=t[Symbol.iterator]();!(l=(f=v.next()).done);l=!0){if(f.value.player===c){u.isBest=!0;break}}}catch(k){h=!0,p=k}finally{try{l||null==v.return||v.return()}finally{if(h)throw p}}var m=!0,d=!1,y=void 0;try{for(var b,w=r[Symbol.iterator]();!(m=(b=w.next()).done);m=!0){if(b.value.player===c){u.isWorst=!0;break}}}catch(k){d=!0,y=k}finally{try{m||null==w.return||w.return()}finally{if(d)throw y}}}}catch(k){a=!0,s=k}finally{try{n||null==o.return||o.return()}finally{if(a)throw s}}}},{key:"_mapPlayerNamesToPlayers",value:function(e){var t=new Map,r=!0,n=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done);r=!0){var o=s.value;t.set(o.username,o)}}catch(c){n=!0,a=c}finally{try{r||null==i.return||i.return()}finally{if(n)throw a}}return t}},{key:"_formatRecord",value:function(e,t){var r=["record"];return t&&r.push("record--overall"),e.isWorst&&r.push("record--worst"),e.isBest&&r.push("record--best"),s.a.createElement("div",{className:r.join(" ")},s.a.createElement("span",{className:"record--value record--wins"},e.wins),"-",s.a.createElement("span",{className:"record--value record--losses"},e.losses),e.ties>0?s.a.createElement("span",null,"-",s.a.createElement("span",{className:"record--value record--ties"},e.ties)):null)}}]),t}(s.a.Component)),L=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={players:[],standings:void 0},r}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this._fetchStandings()}},{key:"render",value:function(){var e=this.state,t=e.players,r=e.standings,n=this.props.game;if(null==r||0===t.length)return null;var a=t.filter(function(e){for(var t=0,n=Object.keys(r.records[e.username]);t<n.length;t++){var a=n[t],s=r.records[e.username][a],i=s.wins,o=s.losses,c=s.ties;if(i>0||o>0||c>0)return!0}return!1});return s.a.createElement("div",{className:"game-dashboard"},s.a.createElement(I,{key:n,game:n,standings:r,players:t}),s.a.createElement(C,{players:a}),s.a.createElement(S,{players:a}))}},{key:"_fetchStandings",value:function(){var e=Object(m.a)(v.a.mark(function e(){var t,r,n,a,s,i,o,c,u,l,h,p,f,m,d,y,b;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getInstance().contents("data/".concat(this.props.game,".json"));case 2:return t=e.sent,r=JSON.parse(t),e.next=6,g.getInstance().players();case 6:n=e.sent,a=[],s=!0,i=!1,o=void 0,e.prev=11,c=n[Symbol.iterator]();case 13:if(s=(u=c.next()).done){e.next=41;break}for(l=u.value,h=void 0,p=!0,f=!1,m=void 0,e.prev=19,d=r.players[Symbol.iterator]();!(p=(y=d.next()).done);p=!0)(b=y.value).username===l.username&&(h=b);e.next=27;break;case 23:e.prev=23,e.t0=e.catch(19),f=!0,m=e.t0;case 27:e.prev=27,e.prev=28,p||null==d.return||d.return();case 30:if(e.prev=30,!f){e.next=33;break}throw m;case 33:return e.finish(30);case 34:return e.finish(27);case 35:if(null!=h){e.next=37;break}return e.abrupt("continue",38);case 37:a.push({avatar:l.avatar,displayName:l.displayName,lastPlayed:new Date(h.lastPlayed),username:l.username});case 38:s=!0,e.next=13;break;case 41:e.next=47;break;case 43:e.prev=43,e.t1=e.catch(11),i=!0,o=e.t1;case 47:e.prev=47,e.prev=48,s||null==c.return||c.return();case 50:if(e.prev=50,!i){e.next=53;break}throw o;case 53:return e.finish(50);case 54:return e.finish(47);case 55:r.players.sort(function(e,t){return e.username.toLowerCase().localeCompare(t.username.toLowerCase())}),a.sort(function(e,t){return e.username.toLowerCase().localeCompare(t.username.toLowerCase())}),this.setState({players:a,standings:r});case 58:case"end":return e.stop()}},e,this,[[11,43,47,55],[19,23,27,35],[28,,30,34],[48,,50,54]])}));return function(){return e.apply(this,arguments)}}()}]),t}(s.a.Component),T=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={games:[]},r}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;b().then(function(t){e.setState({games:t})})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(x,{refreshTime:2e4}),this.state.games.map(function(e){return s.a.createElement(L,{key:e,game:e})}))}}]),t}(s.a.Component);r(274);g.setToken(function(e){if(null!=window.URLSearchParams){var t=new window.URLSearchParams(window.location.search).get(e);return null!=t?t:void 0}}("token")),o.a.render(s.a.createElement(n.a,null,s.a.createElement(T,null)),document.getElementById("root"))}},[[112,1,2]]]);
//# sourceMappingURL=main.1f1ff179.chunk.js.map