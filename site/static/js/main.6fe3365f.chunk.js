(this["webpackJsonpmy-leaderboard"]=this["webpackJsonpmy-leaderboard"]||[]).push([[0],{100:function(e,t,n){e.exports=n(237)},231:function(e,t,n){},232:function(e,t,n){},233:function(e,t,n){},234:function(e,t,n){},235:function(e,t,n){},236:function(e,t,n){},237:function(e,t,n){"use strict";n.r(t);var a=n(10),r=n(0),s=n.n(r),i=n(28),c=n.n(i),o=n(4),l=n.n(o),u=n(12),h=n(11),d=n(17),f=n(16),p=n(18),m=function(){function e(){Object(u.a)(this,e)}return Object(h.a)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}}]),Object(h.a)(e,[{key:"games",value:function(){var t,n;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.awrap(fetch("".concat(e.baseURL,"/games/list")));case 2:return t=a.sent,a.next=5,l.a.awrap(t.json());case 5:return n=a.sent,a.abrupt("return",n);case 7:case"end":return a.stop()}}))}},{key:"players",value:function(){var t,n;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.awrap(fetch("".concat(e.baseURL,"/players/list?includeAvatars=true")));case 2:return t=a.sent,a.next=5,l.a.awrap(t.json());case 5:return n=a.sent,a.abrupt("return",n);case 7:case"end":return a.stop()}}))}},{key:"gameStandings",value:function(t){var n,a;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l.a.awrap(fetch("".concat(e.baseURL,"/games/standings/").concat(t)));case 2:return n=r.sent,r.next=5,l.a.awrap(n.json());case 5:return a=r.sent,r.abrupt("return",a);case 7:case"end":return r.stop()}}))}},{key:"hasUpdates",value:function(t){var n,a;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l.a.awrap(fetch("".concat(e.baseURL,"/misc/hasUpdates?since=").concat(t.toISOString())));case 2:return n=r.sent,r.next=5,l.a.awrap(n.json());case 5:return a=r.sent,r.abrupt("return",a.hasUpdates);case 7:case"end":return r.stop()}}))}}]),e}();m.instance=void 0,m.baseURL="https://myleaderboard.josephroque.dev";var v=m,y=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).refreshInterval=void 0,n.startTime=void 0,n.startTime=new Date,n.state={errorMessage:void 0},n}return Object(p.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this._startRefreshLoop()}},{key:"render",value:function(){var e=this,t=this.state.errorMessage;return null==t?null:s.a.createElement(a.e,{title:""},s.a.createElement(a.c,null,s.a.createElement(a.b,{title:"Failed to refresh",onDismiss:function(){return e._startRefreshLoop()},status:"critical"},s.a.createElement("p",null,t))))}},{key:"_startRefreshLoop",value:function(){var e=this;null!=this.state.errorMessage&&this.setState({errorMessage:void 0}),null!=this.refreshInterval&&window.clearInterval(this.refreshInterval),this.refreshInterval=window.setInterval((function(){return e._refreshLoop()}),this.props.refreshTime)}},{key:"_refreshLoop",value:function(){return l.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.awrap(v.getInstance().hasUpdates(this.startTime));case 3:e.sent&&window.location.reload(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.setState({errorMessage:"".concat(e.t0)});case 10:case"end":return e.stop()}}),null,this,[[0,7]])}}]),t}(s.a.Component);n(231);function b(e){var t=((new Date).getTime()-new Date(e.lastPlayed).getTime())/1e3,n=Math.floor(t/86400);if(n<=7)return 1;if(n>=21)return 0;return Math.max(0,Math.min((14-(n-7))/14,1))}function g(e){return 0===b(e)}n(232);var w=function(e){var t,n=e.player,a=e.record,r=e.banished,i=e.limbo;return t=r||i?1:null!=a?b(a):1,s.a.createElement("img",{src:n.avatar,alt:n.displayName,className:"avatar",style:{opacity:t}})},j=(n(233),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={limboing:[]},n}return Object(p.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.players,n=e.standings,a=t.filter((function(e){var t=n.records[e.id];if(null==t)return!1;var a=b(t);return a>0&&a<.2}));this.setState({limboing:a})}},{key:"render",value:function(){return 0===this.state.limboing.length?null:s.a.createElement(a.e,{title:"Limbo"},s.a.createElement("div",{className:"limbo"},this.state.limboing.map((function(e){return s.a.createElement(w,{key:e.username,player:e,limbo:!0})}))))}}]),t}(s.a.Component)),k=(n(234),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={banished:[]},n}return Object(p.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this._identifyBanishedPlayers()}},{key:"componentDidUpdate",value:function(e){this.props.players!==e.players&&this._identifyBanishedPlayers()}},{key:"render",value:function(){return 0===this.state.banished.length?null:s.a.createElement(a.e,{title:"Shadow Realm"},s.a.createElement("div",{className:"shadowRealm"},this.state.banished.map((function(e){return s.a.createElement(w,{key:e.username,player:e,banished:!0})}))))}},{key:"_identifyBanishedPlayers",value:function(){var e=this.props,t=e.players,n=e.standings,a=t.filter((function(e){var t=n.records[e.id];return null!=t&&g(t)}));this.setState({banished:a})}}]),t}(s.a.Component)),O=n(56);var E=function(){return s.a.createElement("p",null,"v".concat(5,".").concat(0,".").concat(4))},_=(n(235),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={banishedPlayers:new Set},n}return Object(p.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this._parseStandings()}},{key:"componentDidUpdate",value:function(e){this.props.standings!==e.standings&&this._parseStandings()}},{key:"render",value:function(){var e=this,t=this.props,n=t.game,r=t.players,i=t.standings,c=r.filter((function(t){return!1===e.state.banishedPlayers.has(t.id)}));return s.a.createElement(a.e,{title:n.name},s.a.createElement(a.c,null,s.a.createElement(a.d,{columnContentTypes:c.map((function(e){return"text"})),headings:[],rows:[[s.a.createElement(E,null),"Total"].concat(Object(O.a)(c.map((function(e){return s.a.createElement(w,{player:e,record:i.records[e.id]})}))))].concat(Object(O.a)(c.map((function(t){var n=[],a=!0,r=!1,o=void 0;try{for(var l,u=c[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var h=l.value;if(h.username!==t.username){var d=i.records[t.id].records[h.id];null!=d?n.push(e._formatRecord(d,!1)):n.push(e._formatRecord({wins:0,losses:0,ties:0},!1))}else n.push("\u2014")}}catch(f){r=!0,o=f}finally{try{a||null==u.return||u.return()}finally{if(r)throw o}}return[s.a.createElement(w,{key:t.username,player:t,record:i.records[t.id]}),e._formatRecord(i.records[t.id].overallRecord,!0)].concat(n)}))))})))}},{key:"_parseStandings",value:function(){var e=this.props,t=e.players,n=e.standings,a=this._identifyBanishedPlayers(n,t);this.setState({banishedPlayers:a})}},{key:"_identifyBanishedPlayers",value:function(e,t){return new Set(t.filter((function(t){return g(e.records[t.id])})).map((function(e){return e.id})))}},{key:"_formatRecord",value:function(e,t){var n=["record"];return t&&n.push("record--overall"),e.isWorst&&n.push("record--worst"),e.isBest&&n.push("record--best"),s.a.createElement("div",{className:n.join(" ")},s.a.createElement("span",{className:"record--value record--wins"},e.wins),"-",s.a.createElement("span",{className:"record--value record--losses"},e.losses),e.ties>0?s.a.createElement("span",null,"-",s.a.createElement("span",{className:"record--value record--ties"},e.ties)):null)}}]),t}(s.a.Component)),x=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).refreshInterval=void 0,n.state={banishedPlayers:new Set,playersWithGames:[],refresh:!1,standings:void 0},n}return Object(p.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this._fetchStandings(),this._startRefreshLoop()}},{key:"render",value:function(){var e=this,t=this.state,n=t.refresh,r=t.standings,i=t.playersWithGames,c=this.props.game;if(null==r||0===i.length)return null;var o=i.filter((function(t){return!1===e.state.banishedPlayers.has(t.id)}));return i.length>0&&0===o.length?s.a.createElement(a.e,{title:c.name},s.a.createElement("h1",{className:"no-recent-plays"},"No recent plays...")):s.a.createElement("div",{className:"game-dashboard"},s.a.createElement(_,{key:c.id,game:c,standings:r,players:i,forceRefresh:n}),s.a.createElement(j,{standings:r,players:i,forceRefresh:n}),s.a.createElement(k,{standings:r,players:i,forceRefresh:n}))}},{key:"_fetchStandings",value:function(){var e,t,n,a;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.props.players,r.next=3,l.a.awrap(v.getInstance().gameStandings(this.props.game.id));case 3:t=r.sent,n=e.filter((function(e){var n=t.records[e.id];if(null==n)return!1;var a=n.overallRecord,r=a.wins,s=a.losses,i=a.ties;return r>0||s>0||i>0})),a=this._identifyBanishedPlayers(t,n),this.setState({banishedPlayers:a,playersWithGames:n,standings:t});case 7:case"end":return r.stop()}}),null,this)}},{key:"_identifyBanishedPlayers",value:function(e,t){return new Set(t.filter((function(t){return g(e.records[t.id])})).map((function(e){return e.id})))}},{key:"_startRefreshLoop",value:function(){var e=this;null!=this.refreshInterval&&window.clearInterval(this.refreshInterval),this.refreshInterval=window.setInterval((function(){return e._refreshLoop()}),36e5)}},{key:"_refreshLoop",value:function(){return l.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({refresh:!this.state.refresh});case 1:case"end":return e.stop()}}),null,this)}}]),t}(s.a.Component),S=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={games:[],players:[]},n}return Object(p.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this._fetchData()}},{key:"render",value:function(){var e=this.state,t=e.games,n=e.players;return s.a.createElement("div",null,s.a.createElement(y,{refreshTime:2e4}),t.map((function(e){return s.a.createElement(x,{key:e.id,game:e,players:n})})))}},{key:"_fetchData",value:function(){var e,t;return l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.a.awrap(v.getInstance().games());case 2:return e=n.sent,n.next=5,l.a.awrap(v.getInstance().players());case 5:(t=n.sent).sort((function(e,t){return e.username.toLowerCase().localeCompare(t.username.toLowerCase())})),this.setState({games:e,players:t});case 8:case"end":return n.stop()}}),null,this)}}]),t}(s.a.Component);n(236);c.a.render(s.a.createElement(a.a,{i18n:{}},s.a.createElement(S,null)),document.getElementById("root"))}},[[100,1,2]]]);
//# sourceMappingURL=main.6fe3365f.chunk.js.map